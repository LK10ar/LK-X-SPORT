<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LK-X SPORT</title>
    <link rel="icon" type="image/png" href="sport.png">
    <style>
        body { background: #0c0c0c; color: #eee; font-family: 'Segoe UI', sans-serif; margin: 0; padding-bottom: 50px; scroll-behavior: smooth; }
        
        /* EMPECHE LE ZOOM SUR MOBILE LORS DES CLICS RAPIDES */
        button, .btn-round, .counter-value {
            touch-action: manipulation;
        }

        /* --- SPLASH SCREEN NOIR --- */
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 10000;
            transition: opacity 0.8s ease, visibility 0.8s;
        }
        #loading-screen img {
            width: 250px; height: auto;
            animation: pulse 2s infinite ease-in-out;
        }
        #loading-text {
            color: #ff4500; margin-top: 20px; font-weight: bold;
            letter-spacing: 3px; text-transform: uppercase;
        }
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 0.8; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.8; }
        }

        header { display: flex; align-items: center; justify-content: space-between; padding: 0 15px; border-bottom: 1px solid #333; position: sticky; top: 0; background: #0c0c0c; z-index: 100; height: 90px; }
        .burger-menu { width: 40px; cursor: pointer; z-index: 1001; }
        .burger-bar { width: 22px; height: 2px; background-color: #ff4500; margin: 5px 0; }
        h1 { color: #ff4500; margin: 0; font-size: 1.2rem; text-transform: uppercase; letter-spacing: 2px; position: absolute; left: 50%; transform: translateX(-50%); white-space: nowrap; text-align: center; }
        .header-logo { width: 90px; height: 90px; object-fit: contain; }
        
        #back-to-top { position: fixed; bottom: 20px; right: 20px; width: 55px; height: 55px; background: #ff4500; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; cursor: pointer; box-shadow: 0 4px 15px rgba(255, 69, 0, 0.6); z-index: 999; border: none; }
        
        .nav-days { position: fixed; top: 0; left: -100%; height: 100%; width: 260px; background: #0c0c0c; flex-direction: column; padding: 20px; box-shadow: 2px 0 15px rgba(0,0,0,0.8); z-index: 1000; transition: 0.3s; display: flex; }
        .nav-days.open { left: 0; }
        .close-menu { align-self: flex-end; font-size: 2rem; color: #ff4500; cursor: pointer; background: none; border: none; font-weight: bold; margin-bottom: 20px; }
        
        .nav-btn { width: 100%; text-align: left; padding: 15px; background: #1a1a1a; color: #666; border: 1px solid #333; border-radius: 12px; margin-bottom: 10px; cursor: pointer; font-size: 0.85rem; font-weight: bold; text-transform: uppercase; }
        .nav-btn.active { background: #ff4500 !important; color: white !important; border-color: #ff4500 !important; }
        .nav-btn.special { border-color: #00a2ff; color: #00a2ff; }
        .nav-btn.special.active { background: #00a2ff !important; color: white !important; }
        .nav-btn.recipe { border-color: #00ff88; color: #00ff88; }
        .nav-btn.recipe.active { background: #00ff88 !important; color: black !important; }
        
        .app-container { max-width: 600px; margin: auto; padding: 15px; }
        .page-content { display: none; }
        .page-content.active { display: block; }
        
        .section-header { color: #ff4500; font-weight: bold; text-transform: uppercase; margin: 25px 0 15px 0; font-size: 1rem; border-left: 4px solid #ff4500; padding-left: 12px; }
        .section-header.blue { color: #00a2ff; border-left-color: #00a2ff; }
        .section-header.green { color: #00ff88; border-left-color: #00ff88; }
        
        .item-card { background: #111; display: flex; align-items: flex-start; padding: 18px; margin-bottom: 12px; border-radius: 15px; gap: 15px; border: 1px solid #222; }
        .item-info { flex-grow: 1; }
        .item-name { font-weight: bold; display: block; color: #fff; margin-bottom: 5px; font-size: 0.95rem; }
        .item-desc { font-size: 0.8rem; color: #888; line-height: 1.4; }
        .highlight-why { color: #00a2ff; font-weight: bold; display: block; margin-top: 5px; font-size: 0.75rem; }
        
        .points-banner { background: #1a1a1a; padding: 10px; border-radius: 10px; border: 1px solid #00ff88; text-align: center; margin-bottom: 15px; font-weight: bold; }
        .recipe-input-group { background: #111; padding: 20px; border-radius: 15px; border: 1px solid #333; margin-bottom: 20px; }
        .recipe-input-group label { display: block; font-size: 0.75rem; color: #888; margin-top: 10px; text-transform: uppercase; font-weight: bold; }
        .recipe-input-group input, .recipe-input-group select { width: 100%; padding: 12px; margin: 5px 0 10px 0; background: #222; border: 1px solid #444; color: white; border-radius: 8px; box-sizing: border-box; }
        
        .btn-main { width: 100%; background: #ff4500; color: white; border: none; padding: 22px; border-radius: 18px; font-size: 1.1rem; font-weight: bold; cursor: pointer; text-transform: uppercase; }
        .btn-blue { background: #00a2ff !important; }
        
        .supp-table-container { background: #111; border-radius: 15px; overflow: hidden; border: 1px solid #222; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        th { background: #1a1a1a; color: #00a2ff; text-align: left; padding: 12px; text-transform: uppercase; border-bottom: 2px solid #222; }
        td { padding: 12px; border-bottom: 1px solid #222; vertical-align: top; }
        
        .prod-name { color: #fff; font-weight: bold; }
        input[type="checkbox"] { width: 24px; height: 24px; accent-color: #ff4500; cursor: pointer; }
        .video-btn { text-decoration: none; font-size: 1.1rem; background: #1a1a1a; padding: 10px; border-radius: 10px; color: #eee; border: 1px solid #333; align-self: center; }
        
        .setup-card { background: #111; border-radius: 20px; padding: 20px; border: 1px solid #333; margin-bottom: 25px; }
        .control-group { background: #1a1a1a; border-radius: 15px; padding: 12px; margin-bottom: 10px; display: flex; align-items: center; justify-content: space-between; border: 1px solid #222; }
        .control-label { font-weight: bold; font-size: 0.7rem; text-transform: uppercase; color: #ff4500; }
        .counter { display: flex; align-items: center; gap: 15px; }
        .btn-round { background: #333; color: white; border: none; width: 38px; height: 38px; border-radius: 50%; font-size: 1.3rem; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .counter-value { font-size: 1.3rem; font-weight: bold; min-width: 60px; text-align: center; background: #222; border-radius: 5px; padding: 2px 5px; cursor: pointer; }

        .timer-box { text-align: center; padding: 25px; background: #000; border-radius: 25px; margin-bottom: 25px; border: 1px solid #333; }
        .timer-val { font-size: 5.5rem; font-weight: bold; font-family: monospace; line-height: 1; margin: 15px 0; }

        #congrats-overlay {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0);
            background: #ff4500; color: white; padding: 40px; border-radius: 30px;
            font-size: 2.5rem; font-weight: 900; z-index: 9999; text-align: center;
            box-shadow: 0 0 50px rgba(255, 69, 0, 0.8); transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        #congrats-overlay.show { transform: translate(-50%, -50%) scale(1); }
    </style>
</head>
<body>

<div id="loading-screen">
    <img src="sport.png" alt="Logo LK-X">
    <div id="loading-text">Chargement LK-X SPORT...</div>
</div>

<header>
    <div class="burger-menu" id="burger-open"><div class="burger-bar"></div><div class="burger-bar"></div><div class="burger-bar"></div></div>
    <h1>LK-X SPORT</h1>
    <img src="sport.png" alt="Logo" class="header-logo">
</header>

<button id="back-to-top" onclick="window.scrollTo(0,0)">‚ñ≤</button>

<div class="app-container">
    <nav class="nav-days" id="navDays">
        <button class="close-menu" id="burger-close">√ó</button>
        <button class="nav-btn" data-day="1" onclick="showPage('day-1', event)">LUNDI</button>
        <button class="nav-btn" data-day="2" onclick="showPage('day-2', event)">MARDI</button>
        <button class="nav-btn" data-day="4" onclick="showPage('day-4', event)">JEUDI</button>
        <button class="nav-btn" data-day="5" onclick="showPage('day-5', event)">VENDREDI</button>
        <button class="nav-btn" data-day="6" onclick="showPage('day-6', event)">SAMEDI</button>
        <button class="nav-btn all" onclick="showAllDays(event)">TOUT LE PLANNING</button>
        <button class="nav-btn special" data-day="0" onclick="showPage('page-supps', event)">üíä COMPL√âMENTS</button>
        <button class="nav-btn recipe" onclick="showPage('page-recipes', event)">üç≥ RECETTES</button>
    </nav>

    <div id="training-ui">
        <div class="setup-card">
            <div class="control-group">
                <div class="control-label">S√âRIES</div>
                <div class="counter">
                    <button class="btn-round" onclick="updateVal('series', -1)">‚àí</button>
                    <div class="counter-value" id="val-series" onclick="promptVal('series')">4</div>
                    <button class="btn-round" onclick="updateVal('series', 1)">+</button>
                </div>
            </div>
            <div class="control-group">
                <div class="control-label" style="color:#00ff88">TRAVAIL</div>
                <div class="counter">
                    <button class="btn-round" onclick="updateVal('work', -5)">‚àí</button>
                    <div class="counter-value" id="val-work" onclick="promptVal('work')">00:45</div>
                    <button class="btn-round" onclick="updateVal('work', 5)">+</button>
                </div>
            </div>
            <div class="control-group">
                <div class="control-label" style="color:#00a2ff">REPOS</div>
                <div class="counter">
                    <button class="btn-round" onclick="updateVal('rest', -5)">‚àí</button>
                    <div class="counter-value" id="val-rest" onclick="promptVal('rest')">01:30</div>
                    <button class="btn-round" onclick="updateVal('rest', 5)">+</button>
                </div>
            </div>
        </div>
    </div>

    <div id="pages-container">
        <section id="day-1" class="page-content">
            <div class="section-header">JOUR 1 : PUSH (Explosion)</div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">D√©velopp√© Couch√© Halt√®res : 4 x 6-8 reps.</span><span class="item-desc">L'exercice roi pour tes pecs. Vise +2kg par semaine.</span></div><a href="https://www.youtube.com/results?search_query=dumbbell+bench+press+form" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Dips Lest√©s : 3 x 8-10 reps.</span><span class="item-desc">Attache du poids. C'est √ßa qui fait sortir le bas du pec.</span></div><a href="https://www.youtube.com/results?search_query=weighted+dips+form" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">D√©velopp√© assis machine : 3 x 10 reps.</span></div><a href="https://www.youtube.com/results?search_query=chest+press+machine" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Barre au front (EZ) : 4 x 8-10 reps.</span></div><a href="https://www.youtube.com/results?search_query=skullcrusher+ez+bar" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">V-SHAPE : Relev√© de jambes + Halt√®re : 4 x 12 reps.</span></div><a href="https://www.youtube.com/results?search_query=hanging+leg+raise" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card" style="border: 2px solid #00ff88; margin-top: 20px;"><input type="checkbox" class="finish-check"><div class="item-info"><span class="item-name" style="color: #00ff88; font-size: 1.2rem;">EXOS FINI !</span><span class="item-desc">Coche ici quand tu as tout donn√© !</span></div><span style="font-size: 1.5rem;">üèÜ</span></div>
        </section>

        <section id="day-2" class="page-content">
            <div class="section-header">JOUR 2 : PULL (√âpaisseur & Bras)</div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Tirage poitrine large : 4 x 6-8 reps.</span></div><a href="https://www.youtube.com/results?search_query=lat+pulldown" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Rowing Halt√®re 1 bras : 4 x 8 reps.</span></div><a href="https://www.youtube.com/results?search_query=one+arm+row" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Tirage horizontal : 3 x 10 reps.</span></div><a href="https://www.youtube.com/results?search_query=seated+row" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">CURL HALT√àRES : 4 x 6-8 reps.</span></div><a href="https://www.youtube.com/results?search_query=dumbbell+curl" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">V-SHAPE : Crunch poulie haute : 4 x 10 reps.</span></div><a href="https://www.youtube.com/results?search_query=cable+crunch" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card" style="border: 2px solid #00ff88; margin-top: 20px;"><input type="checkbox" class="finish-check"><div class="item-info"><span class="item-name" style="color: #00ff88; font-size: 1.2rem;">EXOS FINI !</span><span class="item-desc">Coche ici quand tu as tout donn√© !</span></div><span style="font-size: 1.5rem;">üèÜ</span></div>
        </section>

        <section id="day-4" class="page-content">
            <div class="section-header">JOUR 4 : UPPER RAPEL (Finition)</div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">D√©velopp√© Inclin√© Halt√®res : 4 x 8 reps.</span></div><a href="https://www.youtube.com/results?search_query=incline+dumbbell+press" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Dips (PDC) : 4 x Max</span></div><a href="https://www.youtube.com/results?search_query=dips+form" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">√âcart√©s poulie vis-√†-vis : 3 x 12 reps.</span></div><a href="https://www.youtube.com/results?search_query=cable+flys" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Curl Marteau : 4 x 10 reps.</span></div><a href="https://www.youtube.com/results?search_query=hammer+curl" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">V-SHAPE : Relev√© de genoux lent : 4 x 15 reps.</span></div><a href="https://www.youtube.com/results?search_query=knee+raise+form" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card" style="border: 2px solid #00ff88; margin-top: 20px;"><input type="checkbox" class="finish-check"><div class="item-info"><span class="item-name" style="color: #00ff88; font-size: 1.2rem;">EXOS FINI !</span><span class="item-desc">Coche ici quand tu as tout donn√© !</span></div><span style="font-size: 1.5rem;">üèÜ</span></div>
        </section>

        <section id="day-5" class="page-content">
            <div class="section-header">JOUR 5 : JAMBES (Force)</div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Presse √† Cuisses : 5 x 8 reps.</span></div><a href="https://www.youtube.com/results?search_query=leg+press+form" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Fentes Bulgares : 3 x 10 reps/jambe.</span></div><a href="https://www.youtube.com/results?search_query=bulgarian+split+squat" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Leg Extension : 3 x 12 reps</span></div><a href="https://www.youtube.com/results?search_query=leg+extension+form" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Leg Curl allong√© : 3 x 10 reps</span></div><a href="https://www.youtube.com/results?search_query=leg+curl+form" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Mollets √† la presse : 4 x 15 reps.</span></div><a href="https://www.youtube.com/results?search_query=calf+press+form" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card" style="border: 2px solid #00ff88; margin-top: 20px;"><input type="checkbox" class="finish-check"><div class="item-info"><span class="item-name" style="color: #00ff88; font-size: 1.2rem;">EXOS FINI !</span><span class="item-desc">Coche ici quand tu as tout donn√© !</span></div><span style="font-size: 1.5rem;">üèÜ</span></div>
        </section>

        <section id="day-6" class="page-content">
            <div class="section-header">JOUR 6 : BRAS & V-SHAPE (Congestion)</div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">SS 1 : Curl Barre EZ + Extensions corde</span></div><a href="https://www.youtube.com/results?search_query=ez+curl+cable+pushdown" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">SS 2 : Curl Inclin√© + Kickback poulie</span></div><a href="https://www.youtube.com/results?search_query=incline+curl+kickback" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Curl Invers√© (Barre EZ) : 3 x 12 reps.</span><span class="item-desc">Pour le dessus de l'avant-bras (brachio-radial).</span></div><a href="https://www.youtube.com/results?search_query=reverse+ez+bar+curl+form" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">Extensions de poignets (Halt√®res) : 3 x 15 reps.</span><span class="item-desc">Pour le relief et les veines sur l'avant-bras.</span></div><a href="https://www.youtube.com/results?search_query=dumbbell+wrist+extension+form" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card"><input type="checkbox"><div class="item-info"><span class="item-name">V-SHAPE : Gainage Planche Lest√©e : 3 x 1 min</span></div><a href="https://www.youtube.com/results?search_query=weighted+plank" target="_blank" class="video-btn">üé¨</a></div>
            <div class="item-card" style="border: 2px solid #00ff88; margin-top: 20px;"><input type="checkbox" class="finish-check"><div class="item-info"><span class="item-name" style="color: #00ff88; font-size: 1.2rem;">EXOS FINI !</span><span class="item-desc">Coche ici quand tu as tout donn√© !</span></div><span style="font-size: 1.5rem;">üèÜ</span></div>
        </section>

        <section id="page-supps" class="page-content">
            <div class="section-header blue">üõí Ta Liste de Courses BioTech USA</div>
            <div class="supp-table-container">
                <table>
                    <thead><tr><th>Produit</th><th>Pourquoi ?</th></tr></thead>
                    <tbody>
                        <tr><td class="prod-name">Hyper Mass</td><td>Prise de masse.</td></tr>
                        <tr><td class="prod-name">100% Creatine</td><td>Force et volume.</td></tr>
                        <tr><td class="prod-name">Black Test</td><td>Hormones.</td></tr>
                        <tr><td class="prod-name">Beta Alanine</td><td>Endurance.</td></tr>
                    </tbody>
                </table>
            </div>
            <div class="section-header blue">üìÖ TON PLANNING DE PRISE</div>
            <div class="item-card"><div class="item-info"><span class="item-name">‚òÄÔ∏è Le Matin</span><span class="item-desc">Hyper Mass : 1 shaker.</span></div></div>
            <div class="item-card"><div class="item-info"><span class="item-name">üïõ Le Midi</span><span class="item-desc">Black Test : 3 g√©lules.</span></div></div>
            <div class="item-card"><div class="item-info"><span class="item-name">üöÄ Avant l'Entra√Ænement</span><span class="item-desc">Pre-workout + Beta-Alanine.</span></div></div>
            <div class="item-card"><div class="item-info"><span class="item-name">üí™ Apr√®s l'Entra√Ænement</span><span class="item-desc">Hyper Mass + 5g Cr√©atine.</span></div></div>
        </section>

        <section id="page-recipes" class="page-content">
            <div class="section-header green">üç≥ RECHERCHE RECETTES</div>
            <div class="points-banner">
                <span id="points-display" style="color:#00ff88">POINTS RESTANTS : 150.0 / 150</span>
                <button onclick="resetPoints()" style="margin-left:10px; background:#333; color:white; border:none; padding:2px 8px; border-radius:5px; cursor:pointer;">RESET</button>
            </div>
            <div class="recipe-input-group" id="recipe-form">
                <input type="text" id="recipe-query" placeholder="ex: Chicken, Pasta..." oninput="calculateLiveCost()">
                <button class="btn-main" id="search-btn" style="background:#00ff88; color:black; margin-top:15px;" onclick="fetchRecipes()">RECHERCHER</button>
            </div>
            <div id="recipes-results"></div>
        </section>
    </div>

    <div id="timer-ui">
        <div class="timer-box">
            <div id="status">Pr√™t ?</div>
            <div id="big-timer" class="timer-val" style="color:#ff4500">00:00</div>
            <div style="color:#555;">S√âRIE <span id="cur-series" style="color:#ff4500">0</span> / <span id="total-series-disp">4</span></div>
        </div>
        <div style="display: flex; gap: 10px;">
            <button id="main-btn" class="btn-main" style="flex: 2;">Lancer la s√©rie</button>
            <button id="pause-btn" class="btn-main btn-blue" style="flex: 1; display: none;">‚è∏</button>
        </div>
    </div>
</div>

<div id="congrats-overlay">BRAVO tu as fini üëç</div>

<script>
    // --- VARIABLES GLOBALES ---
    let config = JSON.parse(localStorage.getItem('timerConfig')) || { series: 4, work: 45, rest: 90 };
    let timerId = null, timeLeft = 0, mode = "IDLE", currentSeries = 0, isPaused = false;
    const apiKey = '01e9145495be4f8981102e39f54ac3f4';
    let remainingPoints = localStorage.getItem('points') ? parseFloat(localStorage.getItem('points')) : 150.0;

    // --- INITIALISATION ---
    window.addEventListener('load', function() {
        // Splash screen
        setTimeout(() => {
            const loader = document.getElementById('loading-screen');
            if(loader) {
                loader.style.opacity = '0';
                setTimeout(() => { loader.style.visibility = 'hidden'; }, 800);
            }
        }, 2500);

        // Charger valeurs chrono
        document.getElementById('val-series').textContent = config.series;
        document.getElementById('total-series-disp').textContent = config.series;
        document.getElementById('val-work').textContent = formatTime(config.work);
        document.getElementById('val-rest').textContent = formatTime(config.rest);

        updatePoints();
        selectCurrentDay(); // AUTO-S√âLECTION DU JOUR ICI
    });

    // --- LOGIQUE NAVIGATION ---
    const burgerOpen = document.getElementById('burger-open'), burgerClose = document.getElementById('burger-close'), navDays = document.getElementById('navDays');
    burgerOpen.onclick = () => navDays.classList.add('open');
    burgerClose.onclick = () => navDays.classList.remove('open');

    function showPage(id, event) {
        document.querySelectorAll('.page-content').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        
        const targetPage = document.getElementById(id);
        if(targetPage) targetPage.classList.add('active');
        
        // Activer le bouton dans le menu
        const btn = document.querySelector(`.nav-btn[onclick*="${id}"]`);
        if(btn) btn.classList.add('active');

        navDays.classList.remove('open');

        const isTraining = id.startsWith('day-');
        document.getElementById('training-ui').style.display = isTraining ? 'block' : 'none';
        document.getElementById('timer-ui').style.display = isTraining ? 'block' : 'none';
        window.scrollTo(0,0);
    }

    function showAllDays() {
        document.querySelectorAll('.page-content').forEach(p => { 
            if(p.id.startsWith('day-')) p.classList.add('active'); 
            else p.classList.remove('active'); 
        });
        navDays.classList.remove('open');
        document.getElementById('training-ui').style.display = 'none';
        document.getElementById('timer-ui').style.display = 'none';
    }

    function selectCurrentDay() {
        const today = new Date().getDay(); // 0=Dim, 1=Lun, 2=Mar, 3=Mer, 4=Jeu, 5=Ven, 6=Sam
        const dayMap = { 1: 'day-1', 2: 'day-2', 4: 'day-4', 5: 'day-5', 6: 'day-6' };
        
        if (dayMap[today]) {
            showPage(dayMap[today]);
        } else {
            showPage('page-supps'); // Mercredi et Dimanche
        }
    }

    // --- CHRONO & REGLAGES ---
    function updateVal(type, mod) {
        if (type === 'series') { 
            config.series = Math.max(1, config.series + mod); 
            document.getElementById('val-series').textContent = config.series; 
            document.getElementById('total-series-disp').textContent = config.series; 
        } else { 
            config[type] = Math.max(5, config[type] + mod); 
            document.getElementById(`val-${type}`).textContent = formatTime(config[type]); 
        }
        localStorage.setItem('timerConfig', JSON.stringify(config));
    }

    function formatTime(s) { 
        let m = Math.floor(s / 60), sec = s % 60; 
        return `${m.toString().padStart(2,'0')}:${sec.toString().padStart(2,'0')}`; 
    }

    function startTimer(type) {
        mode = type; isPaused = false; clearInterval(timerId);
        document.getElementById('pause-btn').style.display = "block";
        if (type === "WORK") { 
            currentSeries++; 
            document.getElementById('cur-series').textContent = currentSeries; 
            timeLeft = config.work; 
            document.getElementById('status').textContent = "TRAVAIL"; 
            document.getElementById('big-timer').style.color = "#ff4500"; 
        } else { 
            timeLeft = config.rest; 
            document.getElementById('status').textContent = "REPOS"; 
            document.getElementById('big-timer').style.color = "#00a2ff"; 
        }
        runCountdown();
    }

    function runCountdown() {
        timerId = setInterval(() => { 
            if (!isPaused) { 
                timeLeft--; 
                document.getElementById('big-timer').textContent = formatTime(timeLeft); 
                if (timeLeft <= 0) { 
                    clearInterval(timerId); 
                    if (mode === "WORK") startTimer("REST");
                    else { 
                        playBellSound(); 
                        if (currentSeries < config.series) startTimer("WORK"); 
                        else resetToIdle(); 
                    }
                } 
            } 
        }, 1000);
    }

    function resetToIdle() { 
        clearInterval(timerId); mode = "IDLE"; currentSeries = 0; 
        document.getElementById('pause-btn').style.display = "none"; 
        document.getElementById('status').textContent = "TERMIN√â !"; 
        document.getElementById('big-timer').style.color = "#00ff88"; 
        document.getElementById('big-timer').textContent = "00:00"; 
    }

    document.getElementById('pause-btn').onclick = function() { 
        isPaused = !isPaused; 
        this.textContent = isPaused ? "‚ñ∂" : "‚è∏"; 
    };

    document.getElementById('main-btn').onclick = () => { 
        if (mode === "IDLE") startTimer("WORK"); 
        else if (mode === "WORK") startTimer("REST"); 
        else if (currentSeries < config.series) startTimer("WORK"); 
        else resetToIdle(); 
    };

    function playBellSound() {
        try {
            const context = new (window.AudioContext || window.webkitAudioContext)();
            const osc = context.createOscillator();
            const gain = context.createGain();
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(880, context.currentTime); 
            gain.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 1);
            osc.connect(gain); gain.connect(context.destination);
            osc.start(); osc.stop(context.currentTime + 1);
        } catch(e) {}
    }

    // --- RECETTES & POINTS ---
    function updatePoints() {
        document.getElementById('points-display').textContent = `POINTS RESTANTS : ${remainingPoints.toFixed(2)} / 150`;
        localStorage.setItem('points', remainingPoints);
    }
    function resetPoints() { remainingPoints = 150.0; updatePoints(); }

    function calculateLiveCost() { return 1.10; }

    async function fetchRecipes() {
        const cost = 1.10;
        if (remainingPoints < cost) { alert("Plus assez de points !"); return; }
        const q = document.getElementById('recipe-query').value;
        const resultsDiv = document.getElementById('recipes-results');
        resultsDiv.innerHTML = '<p>Recherche...</p>';
        try {
            const response = await fetch(`https://api.spoonacular.com/recipes/complexSearch?apiKey=${apiKey}&query=${q}&number=5&addRecipeNutrition=true`);
            const data = await response.json();
            remainingPoints -= cost; updatePoints();
            resultsDiv.innerHTML = '';
            data.results.forEach(recipe => {
                resultsDiv.innerHTML += `<div class="recipe-result-card"><img src="${recipe.image}"><div class="recipe-result-info"><span class="item-name">${recipe.title}</span><button onclick="window.open('https://spoonacular.com/recipes/${recipe.title.replace(/ /g, '-')}-${recipe.id}', '_blank')" class="nav-btn" style="color:#00ff88; border-color:#00ff88; width:auto;">VOIR RECETTE</button></div></div>`;
            });
        } catch (e) { resultsDiv.innerHTML = "Erreur."; }
    }

    // --- CONFETTIS ---
    document.querySelectorAll('.finish-check').forEach(check => {
        check.addEventListener('change', function() {
            if (this.checked) {
                const overlay = document.getElementById('congrats-overlay');
                overlay.classList.add('show');
                // Explosion de confettis
                for (let i = 0; i < 100; i++) {
                    const confetti = document.createElement('div');
                    confetti.style.cssText = `position:fixed; width:8px; height:8px; background:#ff4500; top:-20px; left:${Math.random()*100}vw; z-index:10000;`;
                    document.body.appendChild(confetti);
                    confetti.animate([{ transform: 'translateY(0)', opacity: 1 }, { transform: 'translateY(100vh)', opacity: 0 }], { duration: 2000 }).onfinish = () => confetti.remove();
                }
                setTimeout(() => { overlay.classList.remove('show'); this.checked = false; }, 3000);
            }
        });
    });
</script>

</body>
</html>
